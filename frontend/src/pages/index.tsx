import { useState, useEffect } from 'react';

// Ê®°ÊãüAPIÊï∞ÊçÆ
const mockCompetitors = [
  {
    username: "51talkksa",
    full_name: "51Talk KSA",
    followers_count: 15420,
    posts_count: 248,
    avg_engagement_rate: 0.032,
    content_category_distribution: {
      "Á∫ØÊïôËÇ≤ÂÜÖÂÆπ": 89,
      "‰øÉÈîÄ/ÈîÄÂîÆ": 67,
      "‰∫íÂä®Ê∏∏Êàè/Á´ûËµõ": 45,
      "ÂìÅÁâå/Á§æÂå∫": 34,
      "ÂÖ∂‰ªñ": 13
    }
  },
  {
    username: "novakid_mena", 
    full_name: "Novakid MENA",
    followers_count: 22180,
    posts_count: 312,
    avg_engagement_rate: 0.045,
    content_category_distribution: {
      "Á∫ØÊïôËÇ≤ÂÜÖÂÆπ": 124,
      "‰øÉÈîÄ/ÈîÄÂîÆ": 89,
      "‰∫íÂä®Ê∏∏Êàè/Á´ûËµõ": 67,
      "ÂìÅÁâå/Á§æÂå∫": 23,
      "ÂÖ∂‰ªñ": 9
    }
  },
  {
    username: "vipkid_ar",
    full_name: "VIPKid Arabic", 
    followers_count: 18950,
    posts_count: 198,
    avg_engagement_rate: 0.028,
    content_category_distribution: {
      "Á∫ØÊïôËÇ≤ÂÜÖÂÆπ": 78,
      "‰øÉÈîÄ/ÈîÄÂîÆ": 56,
      "‰∫íÂä®Ê∏∏Êàè/Á´ûËµõ": 34,
      "ÂìÅÁâå/Á§æÂå∫": 21,
      "ÂÖ∂‰ªñ": 9
    }
  }
];

export default function PureDashboard() {
  const [currentTime, setCurrentTime] = useState('');

  useEffect(() => {
    const updateTime = () => {
      setCurrentTime(new Date().toLocaleString('zh-CN'));
    };
    updateTime();
    const timer = setInterval(updateTime, 1000);
    return () => clearInterval(timer);
  }, []);

  const totalFollowers = mockCompetitors.reduce((sum, comp) => sum + comp.followers_count, 0);
  const totalPosts = mockCompetitors.reduce((sum, comp) => sum + comp.posts_count, 0);
  const avgEngagement = mockCompetitors.length > 0 
    ? (mockCompetitors.reduce((sum, comp) => sum + comp.avg_engagement_rate, 0) / mockCompetitors.length * 100).toFixed(2)
    : '0.00';

  return (
    <>
      <style jsx global>{`
        * {
          margin: 0;
          padding: 0;
          box-sizing: border-box;
        }
        
        body {
          font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
          background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
          min-height: 100vh;
        }
        
        .dashboard-container {
          padding: 20px;
          max-width: 1400px;
          margin: 0 auto;
        }
        
        .dashboard-header {
          text-align: center;
          margin-bottom: 40px;
          color: white;
        }
        
        .dashboard-title {
          font-size: 36px;
          font-weight: bold;
          margin: 0 0 10px 0;
          text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .dashboard-subtitle {
          font-size: 16px;
          opacity: 0.9;
          margin: 0;
        }
        
        .metrics-section {
          margin-bottom: 40px;
        }
        
        .section-title {
          font-size: 24px;
          font-weight: bold;
          color: white;
          text-align: center;
          margin-bottom: 20px;
          text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
        }
        
        .metrics-grid {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
          gap: 20px;
          max-width: 1200px;
          margin: 0 auto;
        }
        
        .metric-card {
          background: rgba(255, 255, 255, 0.95);
          padding: 30px;
          border-radius: 15px;
          text-align: center;
          box-shadow: 0 8px 32px rgba(0,0,0,0.1);
          backdrop-filter: blur(10px);
          border: 1px solid rgba(255,255,255,0.2);
          transition: transform 0.3s ease;
        }
        
        .metric-card:hover {
          transform: translateY(-5px);
        }
        
        .metric-icon {
          font-size: 48px;
          margin-bottom: 15px;
        }
        
        .metric-label {
          font-size: 16px;
          color: #666;
          margin: 0 0 10px 0;
          font-weight: 600;
        }
        
        .metric-value {
          font-size: 32px;
          font-weight: bold;
          color: #1890ff;
          margin: 0;
        }
        
        .competitors-section {
          margin-bottom: 40px;
        }
        
        .competitor-grid {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
          gap: 25px;
          max-width: 1400px;
          margin: 0 auto;
        }
        
        .competitor-card {
          background: rgba(255, 255, 255, 0.95);
          padding: 25px;
          border-radius: 15px;
          box-shadow: 0 8px 32px rgba(0,0,0,0.1);
          backdrop-filter: blur(10px);
          border: 1px solid rgba(255,255,255,0.2);
          transition: transform 0.3s ease;
        }
        
        .competitor-card:hover {
          transform: translateY(-3px);
        }
        
        .card-header {
          margin-bottom: 20px;
          padding-bottom: 15px;
          border-bottom: 2px solid #f0f0f0;
        }
        
        .competitor-name {
          font-size: 20px;
          font-weight: bold;
          color: #1a1a1a;
          margin: 0 0 5px 0;
        }
        
        .competitor-full-name {
          font-size: 14px;
          color: #666;
          margin: 0;
        }
        
        .stats-grid {
          display: grid;
          grid-template-columns: 1fr 1fr;
          gap: 15px;
          margin-bottom: 20px;
        }
        
        .stat-item {
          display: flex;
          flex-direction: column;
          align-items: center;
          padding: 10px;
          background-color: #f8f9fa;
          border-radius: 8px;
        }
        
        .stat-label {
          font-size: 12px;
          color: #666;
          margin-bottom: 5px;
          font-weight: 600;
        }
        
        .stat-value {
          font-size: 18px;
          font-weight: bold;
          color: #1890ff;
        }
        
        .content-categories {
          margin-top: 20px;
          padding-top: 20px;
          border-top: 1px solid #f0f0f0;
        }
        
        .categories-title {
          font-size: 16px;
          font-weight: bold;
          color: #333;
          margin: 0 0 15px 0;
        }
        
        .category-list {
          display: flex;
          flex-direction: column;
          gap: 10px;
        }
        
        .category-item {
          display: flex;
          flex-direction: column;
          gap: 5px;
        }
        
        .category-info {
          display: flex;
          justify-content: space-between;
          align-items: center;
        }
        
        .category-name {
          font-size: 14px;
          color: #333;
          font-weight: 500;
        }
        
        .category-count {
          font-size: 14px;
          color: #1890ff;
          font-weight: bold;
        }
        
        .category-bar {
          height: 8px;
          background-color: #f0f0f0;
          border-radius: 4px;
          overflow: hidden;
        }
        
        .category-bar-fill {
          height: 100%;
          background-color: #1890ff;
          border-radius: 4px;
          transition: width 0.3s ease;
        }
        
        .card-actions {
          margin-top: 20px;
          text-align: center;
        }
        
        .instagram-link {
          display: inline-block;
          padding: 10px 20px;
          background-color: #E4405F;
          color: white;
          text-decoration: none;
          border-radius: 25px;
          font-weight: bold;
          transition: background-color 0.3s ease;
          font-size: 14px;
        }
        
        .instagram-link:hover {
          background-color: #C13584;
        }
        
        .insights-section {
          margin-bottom: 40px;
        }
        
        .insights-grid {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
          gap: 20px;
          max-width: 1400px;
          margin: 0 auto;
        }
        
        .insight-card {
          background: rgba(255, 255, 255, 0.95);
          padding: 25px;
          border-radius: 15px;
          box-shadow: 0 8px 32px rgba(0,0,0,0.1);
          backdrop-filter: blur(10px);
          border: 1px solid rgba(255,255,255,0.2);
        }
        
        .footer {
          text-align: center;
          padding: 30px;
          color: white;
          border-top: 1px solid rgba(255,255,255,0.2);
        }
        
        @media (max-width: 768px) {
          .dashboard-title {
            font-size: 28px;
          }
          
          .metrics-grid,
          .competitor-grid {
            grid-template-columns: 1fr;
          }
          
          .stats-grid {
            grid-template-columns: 1fr;
          }
        }
      `}</style>
      
      <div className="dashboard-container">
        <header className="dashboard-header">
          <h1 className="dashboard-title">üá∏üá¶ Ê≤ôÁâπK12Á´ûÂìÅInstagramÂàÜÊûê‰ª™Ë°®Áõò</h1>
          <p className="dashboard-subtitle">ÂÆûÊó∂ÁõëÊéßÁ´û‰∫âÂØπÊâãÁ§æ‰∫§Â™í‰ΩìÁ≠ñÁï• | {currentTime}</p>
        </header>

        <section className="metrics-section">
          <h2 className="section-title">üìä Ê†∏ÂøÉÊåáÊ†áÊÄªËßà</h2>
          <div className="metrics-grid">
            <div className="metric-card">
              <div className="metric-icon">üì±</div>
              <h3 className="metric-label">Á´ûÂìÅÊÄªÊï∞</h3>
              <p className="metric-value">{mockCompetitors.length}</p>
            </div>
            
            <div className="metric-card">
              <div className="metric-icon">üë•</div>
              <h3 className="metric-label">ÊÄªÁ≤â‰∏ùÊï∞</h3>
              <p className="metric-value">{totalFollowers.toLocaleString()}</p>
            </div>
            
            <div className="metric-card">
              <div className="metric-icon">üìù</div>
              <h3 className="metric-label">ÊÄªÂ∏ñÂ≠êÊï∞</h3>
              <p className="metric-value">{totalPosts.toLocaleString()}</p>
            </div>
            
            <div className="metric-card">
              <div className="metric-icon">üíù</div>
              <h3 className="metric-label">Âπ≥Âùá‰∫íÂä®Áéá</h3>
              <p className="metric-value">{avgEngagement}%</p>
            </div>
          </div>
        </section>

        <section className="competitors-section">
          <h2 className="section-title">üèÜ Á´ûÂìÅËØ¶ÁªÜÂàÜÊûê</h2>
          <div className="competitor-grid">{mockCompetitors.map((competitor) => {
              const bestCategory = Object.entries(competitor.content_category_distribution)
                .sort(([,a], [,b]) => b - a)[0];
              
              return (
                <div key={competitor.username} className="competitor-card">
                  <div className="card-header">
                    <h3 className="competitor-name">@{competitor.username}</h3>
                    <p className="competitor-full-name">{competitor.full_name}</p>
                  </div>
                  
                  <div className="stats-grid">
                    <div className="stat-item">
                      <span className="stat-label">Á≤â‰∏ùÊï∞</span>
                      <span className="statValue">{competitor.followers_count.toLocaleString()}</span>
                    </div>
                    
                    <div className="stat-item">
                      <span className="stat-label">Â∏ñÂ≠êÊï∞</span>
                      <span className="statValue">{competitor.posts_count.toLocaleString()}</span>
                    </div>
                    
                    <div className="stat-item">
                      <span className="stat-label">‰∫íÂä®Áéá</span>
                      <span className="statValue">{(competitor.avg_engagement_rate * 100).toFixed(2)}%</span>
                    </div>
                    
                    <div className="stat-item">
                      <span className="stat-label">‰∏ªË¶ÅÂÜÖÂÆπ</span>
                      <span className="statValue">{bestCategory?.[0] || 'Êú™ÂàÜÁ±ª'}</span>
                    </div>
                  </div>
                  
                  <div className="content-categories">
                    <h4 className="categories-title">üìã ÂÜÖÂÆπÂàÜÁ±ªÂàÜÂ∏É</h4>
                    <div className="category-list">
                      {Object.entries(competitor.content_category_distribution).map(([category, count]) => (
                        <div key={category} className="category-item">
                          <div className="category-info">
                            <span className="category-name">{category}</span>
                            <span className="category-count">{count} Â∏ñÂ≠ê</span>
                          </div>
                          <div className="category-bar">
                            <div 
                              className="category-bar-fill"
                              style={{
                                width: `${(count / competitor.posts_count) * 100}%`
                              }}
                            ></div>
                          </div>
                        </div>
                      ))}
                    </div>
                  </div>
                  
                  <div className="card-actions">
                    <a 
                      href={`https://instagram.com/${competitor.username}`}
                      target="_blank"
                      rel="noopener noreferrer"
                      className="instagram-link"
                    >
                      üì± ËÆøÈóÆInstagram‰∏ªÈ°µ
                    </a>
                  </div>
                </div>
              );
            })}
          </div>
        </section>

        <section className="insights-section">
          <h2 className="section-title">üí° ÂÖ≥ÈîÆÊ¥ûÂØü</h2>
          <div className="insights-grid">
            <div className="insight-card">
              <h4>üéØ ÂÜÖÂÆπÁ≠ñÁï•Âª∫ËÆÆ</h4>
              <p>"‰∫íÂä®Ê∏∏Êàè/Á´ûËµõ"Á±ªÂÜÖÂÆπË°®Áé∞ÊúÄ‰Ω≥ÔºåÂª∫ËÆÆÂ¢ûÂä†Ê≠§Á±ªÂÜÖÂÆπÂèëÂ∏ÉÈ¢ëÁéá</p>
            </div>
            
            <div className="insight-card">
              <h4>‚è∞ ÂèëÂ∏ÉÊó∂Êú∫</h4>
              <p>Ê≤ôÁâπÊó∂Èó¥ÊôöÈó¥18:00-22:00‰∏∫ÊúÄ‰Ω≥ÂèëÂ∏ÉÊó∂Èó¥</p>
            </div>
            
            <div className="insight-card">
              <h4>üìà Â∏ÇÂú∫Ë∂ãÂäø</h4>
              <p>Âú®Á∫øK12Ëã±ËØ≠ÊïôËÇ≤Âú®Ê≤ôÁâπÂ∏ÇÂú∫ÊåÅÁª≠Â¢ûÈïøÔºåÁ´û‰∫âÊøÄÁÉà</p>
            </div>
            
            <div className="insight-card">
              <h4>üèÜ ÊúÄ‰Ω≥ÂÆûË∑µ</h4>
              <p>Â≠¶‰π†novakid_menaÁöÑÂÜÖÂÆπÁ≠ñÁï•ÔºåÂÖ∂‰∫íÂä®ÁéáÊúÄÈ´ò(4.5%)</p>
            </div>
          </div>
        </section>

        <footer className="footer">
          <p>üöÄ Âü∫‰∫éInstagram APIÂÆûÊó∂Êï∞ÊçÆÂàÜÊûê | ‰∏ì‰∏∫Ê≤ôÁâπK12ÊïôËÇ≤Â∏ÇÂú∫ÂÆöÂà∂</p>
          <p>üìä Êï∞ÊçÆÊõ¥Êñ∞Êó∂Èó¥: {currentTime} | ËøΩË∏™Á´ûÂìÅ: @51talkksa @novakid_mena @vipkid_ar</p>
        </footer>
      </div>
    </>
  );
}